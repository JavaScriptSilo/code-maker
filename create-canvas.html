<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Code Maker</title>
  <link rel="stylesheet" href="createCanvas.css"/>
  <style>
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(120deg, #1e3c72, #2a5298, #00c6ff 90%);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .topBar {
      width: 100%;
      height: 60px;
      background-color: #2A2D89;
      display: flex;
      align-items: center;
      padding: 0 30px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    #homelink {
      font-family: "Comic Sans MS", "Comic Sans", cursive;
      font-size: 26px;
      color: #fff;
      text-decoration: none;
    }

    .controls {
      margin-top: 80px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .controls input, .controls button {
      padding: 10px 15px;
      border-radius: 8px;
      border: none;
      font-size: 16px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .controls input {
      width: 200px;
    }

    button {
      background-color: #444;
      color: white;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
    }

    button:hover {
      background-color: #666;
    }

    #codeBox {
      margin-top: 40px;
      max-width: 90%;
      background: rgba(0,0,0,0.4);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    canvas {
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <div class="topBar">
    <a href="index.html" id="homelink">Home</a>
  </div>

  <div class="controls" id="canvasControls">
    <input type="text" id="heightInput" placeholder="Enter Height">
    <button id="setHeight">Set Height</button>
    <input type="text" id="widthInput" placeholder="Enter Width">
    <button id="setWidth">Set Width</button>
    <input type="text" id="backgroundInput" placeholder="Enter Background Color">
    <button id="setBackground">Set Background</button>
    <input type="text" id="squareSizeInput" placeholder="Enter Square Size">
    <button id="squareSize">Change Square Size</button>
    <button id="drawToggle">Toggle Square Drawing</button>
    <button id="newCanvas">New Frame</button>
    <button id="clearCanvas">Clear Canvas</button>
  </div>
  
  <div id="canvasContainer"></div>

  <div id="codeBox">
    <p id="codeText"></p>
  </div>

<script>
  const canvasWidthDefault = 500;
  const canvasHeightDefault = 300;
  let canvasWidth = canvasWidthDefault;
  let canvasHeight = canvasHeightDefault;
  let canvasBackground = "none";
  let isDrawing = false;
  let squares = [];
  let size = 50; // Default square size
  let canvases = [];
  let activeCanvasId = null;


  function createBox() {
      const canvas = document.createElement("canvas");
      canvas.id = "canvas0"; // Use a consistent ID
      canvas.width = canvasWidth;
      canvas.height = canvasHeight;
      canvas.style.border = "1px solid black";
      canvas.style.backgroundColor = canvasBackground === "" ? "powderblue" : canvasBackground;

      canvas.onclick = () => {
          activeCanvasId = canvas.id;
          canvases.forEach(c => {
          document.getElementById(c.id).style.boxShadow = "none";
          });
          canvas.style.boxShadow = "0 0 10px 2px yellow";
          createCode();
      };

      document.getElementById("canvasContainer").innerHTML = '';
      document.getElementById("canvasContainer").appendChild(canvas);

      // Track the canvas
      canvases = [{
          id: canvas.id,
          squares: [],
          size: size,
          background: canvasBackground
      }];

    activeCanvasId = canvas.id;
  }


  function setupControls() {
    document.getElementById("setWidth").onclick = () => {
        const newWidth = parseInt(document.getElementById("widthInput").value);
        if (isNaN(newWidth) || !activeCanvasId) return;

        const canvas = document.getElementById(activeCanvasId);
        const canvasData = canvases.find(c => c.id === activeCanvasId);

        canvas.width = newWidth;
        canvasData.width = newWidth;
        canvasWidth = newWidth; // Optional: update global default

        createCode(canvasData);
    };

    document.getElementById("setHeight").onclick = () => {
        const newHeight = parseInt(document.getElementById("heightInput").value);
        if (isNaN(newHeight) || !activeCanvasId) return;

        const canvas = document.getElementById(activeCanvasId);
        const canvasData = canvases.find(c => c.id === activeCanvasId);

        canvas.height = newHeight;
        canvasData.height = newHeight;
        canvasHeight = newHeight; // Optional: update global default

        createCode(canvasData);
    };



    document.getElementById("setBackground").onclick = () => {
        const color = document.getElementById("backgroundInput").value.trim().toLowerCase();
        const validColors = new Set(["white", "black", "red", "orange", "yellow", "green", "blue", "purple", "none"]);

        if (!activeCanvasId || !validColors.has(color)) return;

        const canvas = document.getElementById(activeCanvasId);
        const canvasData = canvases.find(c => c.id === activeCanvasId);

        const finalColor = color === "none" ? "powderblue" : color;
        canvas.style.backgroundColor = finalColor;
        canvasData.background = finalColor;

        createCode(canvasData);
    };

    document.getElementById("drawToggle").onclick = () => {
      isDrawing = !isDrawing;
    };
    
    document.getElementById("squareSize").onclick = () => {
      const newSize = parseInt(document.getElementById("squareSizeInput").value);
      if (!isNaN(newSize)) {
        size = newSize;
        createCode();
      }
    };

    document.getElementById("clearCanvas").onclick = () => {
        if (!activeCanvasId) return;
        const canvas = document.getElementById(activeCanvasId);
        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const canvasData = canvases.find(c => c.id === activeCanvasId);
        canvasData.squares = [];

        createCode(canvasData);
    };


    document.addEventListener("click", function(e) {
        if (!isDrawing || !activeCanvasId) return;

        const canvas = document.getElementById(activeCanvasId);
        if (!canvas || e.target !== canvas) return;

        const ctx = canvas.getContext("2d");
        const rectX = e.offsetX - size / 2;
        const rectY = e.offsetY - size / 2;

        ctx.fillStyle = "black";
        ctx.fillRect(rectX, rectY, size, size);

        const canvasData = canvases.find(c => c.id === activeCanvasId);
        canvasData.squares.push({x: rectX, y: rectY, s: size});

        createCode(canvasData);
    });

    let idNum = 0;
    let newFrameBttn = document.getElementById("newCanvas");
    newFrameBttn.onclick = function() {
        idNum += 1;
        const canvas = document.createElement("canvas");
        canvas.id = `canvas${idNum}`;
        canvas.width = canvasWidth;
        canvas.height = canvasHeight;
        canvas.style.border = "1px solid black";
        canvas.style.marginTop = "30px";
        canvas.style.backgroundColor = canvasBackground === "" ? "powderblue" : canvasBackground;

        canvas.onclick = () => {
            activeCanvasId = canvas.id;
            canvases.forEach(c => {
                document.getElementById(c.id).style.boxShadow = "none";
            });
            canvas.style.boxShadow = "0 0 10px 2px yellow";
            createCode();
        };

        canvases.push({
            id: canvas.id,
            squares: [],
            size: size,
            background: canvasBackground
        });

        document.getElementById("canvasContainer").appendChild(canvas);
        activeCanvasId = canvas.id;
    };

  }

  function createCode(canvasData = canvases.find(c => c.id === activeCanvasId)) {
    if (!canvasData) return;

    let squareCode = canvasData.squares.map(sq => `ctx.fillRect(${sq.x}, ${sq.y}, ${sq.s}, ${sq.s});<br>`).join("");
    let code = `&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;&lt;/head&gt;<br>&lt;body&gt;<br>&lt;script&gt;<br>
        const canvas = document.createElement('canvas');<br>
        const ctx = canvas.getContext("2d");<br>
        canvas.width = ${canvasWidth};<br>
        canvas.height = ${canvasHeight};<br>
        canvas.style.backgroundColor = '${canvasData.background}';<br>
        ctx.fillStyle = "black";<br>
        ${squareCode}document.body.appendChild(canvas);<br>
        &lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;`;
    document.getElementById("codeText").innerHTML = code;
  }

  window.onload = () => {
    createBox();
    setupControls();
    createCode();
  };
</script>
</body>
</html>
